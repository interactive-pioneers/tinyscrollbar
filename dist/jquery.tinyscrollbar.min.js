/*! tinyscrollbar - v2.1.2 - 2014-01-16
* https://github.com/interactive-pioneers/tinyscrollbar
* Copyright (c) 2014 Ain Tohvri; Licensed MIT */
!function(a){function b(b,c){function d(){return n.update(),f(),n}function e(){var a=x.toLowerCase();u.obj.css(w,y/s.ratio),r.obj.css(w,-y),A.start=u.obj.offset()[w],s.obj.css(a,t[c.axis]),t.obj.css(a,t[c.axis]),u.obj.css(a,u[c.axis])}function f(){B?q.obj[0].ontouchstart=function(a){1===a.touches.length&&(g(a.touches[0]),a.stopPropagation())}:u.obj.on("mousedown",g).on("mouseup",k),c.scroll&&window.addEventListener?(p[0].addEventListener("DOMMouseScroll",h,!1),p[0].addEventListener("mousewheel",h,!1)):c.scroll&&(p[0].onmousewheel=h)}function g(b){a("body").addClass("noSelect");var c=parseInt(u.obj.css(w),10);A.start=v?b.pageX:b.pageY,z.start="auto"===c?0:c,B?(document.ontouchmove=function(a){a.preventDefault(),k(a.touches[0])},document.ontouchend=l):(a(document).on("mousemove",k).on("mouseup",l),u.obj.on("mouseup",l))}function h(b){if(r.ratio<1){var d=b||window.event,e=d.wheelDelta?d.wheelDelta/120:-d.detail/3;y-=e*c.wheel,y=Math.min(r[c.axis]-q[c.axis],Math.max(0,y)),u.obj.css(w,y/s.ratio),r.obj.css(w,-y),i(),(c.lockscroll||y!==r[c.axis]-q[c.axis]&&0!==y)&&(d=a.event.fix(d),d.preventDefault())}}function i(){if(o)return!1;var a=r[c.axis],b=a-q[c.axis],d=b*c.enddetection;y>d&&b>y&&(o=!0,j(),m=setInterval(function(){a<r[c.axis]&&(clearInterval(m),o=!1)},400))}function j(){a(b).trigger(a.Event("enddetected"))}function k(a){r.ratio<1&&(z.now=c.invertscroll&&B?Math.min(t[c.axis]-u[c.axis],Math.max(0,z.start+(A.start-(v?a.pageX:a.pageY)))):Math.min(t[c.axis]-u[c.axis],Math.max(0,z.start+((v?a.pageX:a.pageY)-A.start))),y=z.now*s.ratio,r.obj.css(w,-y),u.obj.css(w,z.now),i())}function l(){a("body").removeClass("noSelect"),a(document).off("mousemove",k).off("mouseup",l),u.obj.off("mouseup",l),document.ontouchmove=document.ontouchend=null}var m,n=this,o=!1,p=b,q={obj:a(".viewport",b)},r={obj:a(".overview",b)},s={obj:a(".scrollbar",b)},t={obj:a(".track",s.obj)},u={obj:a(".thumb",s.obj)},v="x"===c.axis,w=v?"left":"top",x=v?"Width":"Height",y=0,z={start:0,now:0},A={},B="ontouchstart"in document.documentElement;return this.update=function(a){q[c.axis]=q.obj[0]["offset"+x],r[c.axis]=r.obj[0]["scroll"+x],r.ratio=q[c.axis]/r[c.axis],s.obj.toggleClass("disable",r.ratio>=1),t[c.axis]="auto"===c.size?q[c.axis]:c.size,u[c.axis]=Math.min(t[c.axis],Math.max(0,"auto"===c.sizethumb?t[c.axis]*r.ratio:c.sizethumb)),s.ratio="auto"===c.sizethumb?r[c.axis]/t[c.axis]:(r[c.axis]-q[c.axis])/(t[c.axis]-u[c.axis]),y="relative"===a&&r.ratio<=1?Math.min(r[c.axis]-q[c.axis],Math.max(0,y)):0,y="bottom"===a&&r.ratio<=1?r[c.axis]-q[c.axis]:isNaN(parseInt(a,10))?y:parseInt(a,10),e()},d()}a.tiny=a.tiny||{},a.tiny.scrollbar={options:{axis:"y",wheel:40,scroll:!0,lockscroll:!0,size:"auto",sizethumb:"auto",invertscroll:!1,enddetection:.9}},a.fn.tinyscrollbar=function(c){var d=a.extend({},a.tiny.scrollbar.options,c);return this.each(function(){a(this).data("tsb",new b(a(this),d))}),this},a.fn.tinyscrollbar_update=function(b){return a(this).data("tsb").update(b)}}(jQuery);