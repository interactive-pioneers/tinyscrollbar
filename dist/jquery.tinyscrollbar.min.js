/*! tinyscrollbar - v2.0.0 - 2014-01-13
* https://github.com/interactive-pioneers/tinyscrollbar
* Copyright (c) 2014 Ain Tohvri; Licensed MIT */
!function(a){function b(b,c){function d(){return m.update(),f(),m}function e(){var a=w.toLowerCase();t.obj.css(v,x/r.ratio),q.obj.css(v,-x),z.start=t.obj.offset()[v],r.obj.css(a,s[c.axis]),s.obj.css(a,s[c.axis]),t.obj.css(a,t[c.axis])}function f(){A?p.obj[0].ontouchstart=function(a){1===a.touches.length&&(g(a.touches[0]),a.stopPropagation())}:(t.obj.bind("mousedown",g),s.obj.bind("mouseup",j)),c.scroll&&window.addEventListener?(o[0].addEventListener("DOMMouseScroll",h,!1),o[0].addEventListener("mousewheel",h,!1)):c.scroll&&(o[0].onmousewheel=h)}function g(b){a("body").addClass("noSelect");var c=parseInt(t.obj.css(v),10);z.start=u?b.pageX:b.pageY,y.start="auto"===c?0:c,A?(document.ontouchmove=function(a){a.preventDefault(),j(a.touches[0])},document.ontouchend=k):(a(document).bind("mousemove",j),a(document).bind("mouseup",k),t.obj.bind("mouseup",k))}function h(b){if(q.ratio<1){var d=b||window.event,e=d.wheelDelta?d.wheelDelta/120:-d.detail/3;x-=e*c.wheel,x=Math.min(q[c.axis]-p[c.axis],Math.max(0,x)),t.obj.css(v,x/r.ratio),q.obj.css(v,-x),i(),(c.lockscroll||x!==q[c.axis]-p[c.axis]&&0!==x)&&(d=a.event.fix(d),d.preventDefault())}}function i(){if(n)return!1;var a=q[c.axis],b=a-p[c.axis],d=b*c.enddetection;x>d&&b>x&&(n=!0,setTimeout(function(){console.log("appending to ",q.obj),q.obj.append("------<br>Robot<br>Robot<br>Robot<br>Robot<br>Robot<br>Robot<br>Robot<br>Robot<br>Robot<br>Robot<br>Robot<br>---------"),m.update("relative")},2e3),l=setInterval(function(){a<q[c.axis]&&(clearInterval(l),n=!1)},400))}function j(a){q.ratio<1&&(y.now=c.invertscroll&&A?Math.min(s[c.axis]-t[c.axis],Math.max(0,y.start+(z.start-(u?a.pageX:a.pageY)))):Math.min(s[c.axis]-t[c.axis],Math.max(0,y.start+((u?a.pageX:a.pageY)-z.start))),x=y.now*r.ratio,q.obj.css(v,-x),t.obj.css(v,y.now))}function k(){a("body").removeClass("noSelect"),a(document).unbind("mousemove",j),a(document).unbind("mouseup",k),t.obj.unbind("mouseup",k),document.ontouchmove=document.ontouchend=null}var l,m=this,n=!1,o=b,p={obj:a(".viewport",b)},q={obj:a(".overview",b)},r={obj:a(".scrollbar",b)},s={obj:a(".track",r.obj)},t={obj:a(".thumb",r.obj)},u="x"===c.axis,v=u?"left":"top",w=u?"Width":"Height",x=0,y={start:0,now:0},z={},A="ontouchstart"in document.documentElement;return this.update=function(a){p[c.axis]=p.obj[0]["offset"+w],q[c.axis]=q.obj[0]["scroll"+w],q.ratio=p[c.axis]/q[c.axis],r.obj.toggleClass("disable",q.ratio>=1),s[c.axis]="auto"===c.size?p[c.axis]:c.size,t[c.axis]=Math.min(s[c.axis],Math.max(0,"auto"===c.sizethumb?s[c.axis]*q.ratio:c.sizethumb)),r.ratio="auto"===c.sizethumb?q[c.axis]/s[c.axis]:(q[c.axis]-p[c.axis])/(s[c.axis]-t[c.axis]),x="relative"===a&&q.ratio<=1?Math.min(q[c.axis]-p[c.axis],Math.max(0,x)):0,x="bottom"===a&&q.ratio<=1?q[c.axis]-p[c.axis]:isNaN(parseInt(a,10))?x:parseInt(a,10),e()},d()}a.tiny=a.tiny||{},a.tiny.scrollbar={options:{axis:"y",wheel:40,scroll:!0,lockscroll:!0,size:"auto",sizethumb:"auto",invertscroll:!1,enddetection:.9}},a.fn.tinyscrollbar=function(c){var d=a.extend({},a.tiny.scrollbar.options,c);return this.each(function(){a(this).data("tsb",new b(a(this),d))}),this},a.fn.tinyscrollbar_update=function(b){return a(this).data("tsb").update(b)}}(jQuery);